<%- include('../partials/header') %>

<section id="show-page">
  <div>Airline: </div>
  <div><%= flights.airline %></div>
  <div>Flight Number:</div>
  <div><%= flights.flightNo %></div>
  <div>Departure: </div>
  <div><%= flights.departs %></div>
  <div>Arrival</div>
  <div><%= flights.arrival %></div>
  <div>Destinations</div>
  <div><%= destination.airport %></div>
  <div><%= destination.arrival %></div>
  
  <!-- start list -->
  <div>Flights:</div>
   <ul>
    <%- flight.destinations.map(p => 
      `<li>${f.name} <small>${f.departs.toLocaleDateString()}</small></li>`
    ).join('') 
    %>
    <%- Flight.findById(req.params.id, function(err, flight) {
      Ticket.find({flight: flight._id}, function(err, tickets) {
        // Now you can pass both the flight and tickets in the res.render call
   Ticket.findById(req.params.id)
   .populate('flight')
   .exec(function(err, ticket))
      });
  }); -%>
    
  </ul> 
  <!-- end list-->
</section>
<!-- add destination form below this comment -->
<form id="add-destination" action="/flights/<%= destination.airport %>" method="POST">
  <select name="destination">
    <!-- Emit an option for each destination -->
    <%- flights.map(f => 
      `<option value="${f._flightNo}">${d.airline}</option>`
    ).join('') %>
  </select>
  <button type="submit">Add to Flight</button>
</form>


  
<%- include('../partials/footer') %>
